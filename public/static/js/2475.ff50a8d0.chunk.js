"use strict";(self.webpackChunkabokisub_recovered=self.webpackChunkabokisub_recovered||[]).push([[2475],{24753(e,t,n){n.d(t,{A:()=>g});var r=n(89379),s=n(80045),o=n(90620),i=n.n(o),a=n(96446),l=n(85865),d=n(88446),c=n(35475),u=n(22698),p=n(70579);const h=["links","activeLast"];function m(e){let{links:t,activeLast:n=!1}=e,o=(0,s.A)(e,h);const i=t[t.length-1].name,d=t.map(e=>(0,p.jsx)(x,{link:e},e.name)),c=t.map(e=>(0,p.jsx)("div",{children:e.name!==i?(0,p.jsx)(x,{link:e}):(0,p.jsx)(l.A,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:i})},e.name));return(0,p.jsx)(u.A,(0,r.A)((0,r.A)({separator:(0,p.jsx)(a.A,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})},o),{},{children:n?d:c}))}function x(e){let{link:t}=e;const{href:n,name:r,icon:s}=t;return(0,p.jsxs)(d.A,{variant:"body2",component:c.N_,to:n||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[s&&(0,p.jsx)(a.A,{sx:{mr:1,"& svg":{width:20,height:20}},children:s}),r]},r)}const v=["links","action","heading","moreLink","sx"];function g(e){let{links:t,action:n,heading:o,moreLink:c=[],sx:u}=e,h=(0,s.A)(e,v);return(0,p.jsxs)(a.A,{sx:(0,r.A)({mb:5},u),children:[(0,p.jsxs)(a.A,{sx:{display:"flex",alignItems:"center"},children:[(0,p.jsxs)(a.A,{sx:{flexGrow:1},children:[(0,p.jsx)(l.A,{variant:"h4",gutterBottom:!0,children:o}),(0,p.jsx)(m,(0,r.A)({links:t},h))]}),n&&(0,p.jsx)(a.A,{sx:{flexShrink:0},children:n})]}),(0,p.jsx)(a.A,{sx:{mt:2},children:i()(c)?(0,p.jsx)(d.A,{href:c,target:"_blank",rel:"noopener",variant:"body2",children:c}):c.map(e=>(0,p.jsx)(d.A,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e))})]})}},92475(e,t,n){n.r(t),n.d(t,{default:()=>O});var r=n(19252),s=n(48407),o=n(11737),i=n(19838),a=n(24753),l=n(80899),d=n(65043),c=n(46987),u=n(73216),p=n(73023),h=n.n(p),m=n(24858),x=n(18403),v=n(72812),g=n(85865),A=n(68903),b=n(12110),f=n(88911),j=n(96446),w=n(67254),y=n(39336),k=n(84473),S=n(33708),C=n(73338),I=n(30342),R=n(26776),T=n(43409),P=n(70579);function N(){var e,t,n,r,o,i,a;const{enqueueSnackbar:p}=(0,c.dh)(),N=(0,u.Zp)(),[O,E]=(0,d.useState)(),[q,V]=(0,d.useState)(""),[B,M]=(0,d.useState)(!1),[Y,_]=(0,d.useState)(!1),L=window.localStorage.getItem("accessToken"),{setting:W}=(0,I.A)(),X=((0,T.A)(),1===(null===W||void 0===W||null===(e=W.setting)||void 0===e?void 0:e.allow_pin)),[z,F]=(0,d.useState)("INIT"),[$,D]=(0,d.useState)(""),[U,G]=(0,d.useState)(""),[H,Z]=(0,d.useState)("0.00"),[K,J]=(0,d.useState)(null),[Q,ee]=(0,d.useState)(60),[te,ne]=(0,d.useState)(!1),re=l.Ik().shape({phone:l.Yj().required("Sender Phone Number Required").min(11,"Must be at least 11 digits"),network:l.Yj().required("Network Required"),otp:l.Yj().when("$step",{is:"VERIFY",then:e=>e.required("OTP Required").length(6,"OTP must be 6 digits"),otherwise:e=>e.notRequired()}),amount:l.ai().transform(e=>isNaN(e)?void 0:e).when("$step",{is:"CONVERT",then:e=>e.required("Amount Required").positive("Amount must be positive"),otherwise:e=>e.notRequired()}),transferPin:l.Yj().when("$step",{is:"CONVERT",then:e=>e.required("Share and Sell PIN Required"),otherwise:e=>e.notRequired()}),type:l.Yj().when("$step",{is:"CONVERT",then:e=>e.required("Payment Method Required"),otherwise:e=>e.notRequired()}),pin:l.Yj().when(["$step","$pin_enabled"],{is:(e,t)=>"CONVERT"===e&&t,then:e=>e.required("System Transaction Pin Required"),otherwise:e=>e.notRequired()})}),se=(0,m.mN)({resolver:(0,x.t)(re),context:{step:z,pin_enabled:X},defaultValues:{phone:"",network:"",otp:"",amount:"",transferPin:"",type:"wallet",pin:""}}),{setValue:oe,watch:ie,handleSubmit:ae,formState:{errors:le}}=se,de=ie();(0,d.useEffect)(()=>{k.A.get("/api/website/app/network").then(e=>{var t;E(null===(t=e.data)||void 0===t?void 0:t.network)})},[]),(0,d.useEffect)(()=>{let e;return"VERIFY"===z&&Q>0&&(e=setInterval(()=>{ee(e=>e<=1?(ne(!0),0):e-1)},1e3)),()=>clearInterval(e)},[z,Q]),(0,d.useEffect)(()=>{se.reset(de,{keepValues:!0,keepDefaultValues:!0,context:{step:z,pin_enabled:X}})},[z,X]);return(0,P.jsx)(S.Op,{methods:se,onSubmit:ae(e=>{"INIT"===z?(async e=>{M(!0);try{const t=await k.A.post("/api/autopilot/a2c/otp",{network:e.network,sender_number:e.phone,amount:100});D(t.data.identifier),ee(60),ne(!1),F("VERIFY"),p("OTP sent to your phone")}catch(r){var t,n;p((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Error sending OTP",{variant:"error"})}M(!1)})(e):"VERIFY"===z?(async e=>{M(!0);try{const t=await k.A.post("/api/autopilot/a2c/verify",{identifier:$,otp:e.otp});G(t.data.sessionId),Z(t.data.balance),F("CONVERT"),p("OTP verified successfully")}catch(r){var t,n;p((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Verification failed",{variant:"error"})}M(!1)})(e):"CONVERT"===z&&(async e=>{M(!0);try{const t=await k.A.post("/api/cash",{network:e.network,payment_type:e.type,sender_number:e.phone,amount:e.amount,token:L,pin:e.pin,bypass:!1,automated:!0});await k.A.post("/api/autopilot/a2c/submit",{sessionId:U,transid:t.data.transid,transferPin:e.transferPin}),h()("Success","Airtime conversion successful","success"),N("".concat(s.nB.general.invioce,"/").concat(t.data.transid,"/airtimecash"),{replace:!0})}catch(r){var t,n;p((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Conversion failed",{variant:"error"})}M(!1)})(e)}),children:(0,P.jsx)(A.Ay,{container:!0,spacing:3,children:(0,P.jsx)(A.Ay,{item:!0,xs:12,md:8,children:(0,P.jsx)(b.A,{sx:{p:3},children:(0,P.jsxs)(f.A,{spacing:3,children:[(0,P.jsx)(g.A,{variant:"h5",align:"center",gutterBottom:!0,children:"Automated Airtime to Cash"}),"INIT"===z&&(0,P.jsxs)(f.A,{spacing:3,children:[(0,P.jsxs)(S.tX,{name:"network",label:"Select Network",error:!!le.network,helperText:null===(t=le.network)||void 0===t?void 0:t.message,children:[(0,P.jsx)("option",{value:""}),null===O||void 0===O?void 0:O.map(e=>(0,P.jsx)("option",{value:null===e||void 0===e?void 0:e.network,disabled:0===(null===e||void 0===e?void 0:e.cash),children:null===e||void 0===e?void 0:e.network},null===e||void 0===e?void 0:e.code))]}),(0,P.jsx)(S.o3,{name:"phone",label:"Sender Phone Number",type:"number",placeholder:"080XXXXXXXX",onChange:e=>{const t=e.target.value;if(oe("phone",t),""===t||t.length<6)return void V("");let n="Unable to identify network !";/0702|0704|0803|0806|0703|0706|0813|0816|0810|0814|0903|0906|0913|0713|0716|0916/.test(t)?n="MTN":/0805|0807|0705|0815|0811|0905|0907|0707|0817|0917|0717|0715|0915|0711|0911/.test(t)?n="GLO":/0802|0808|0708|0812|0701|0901|0902|0907|0912|0904|0908|0918|0818|0718|0712|0801/.test(t)?n="AIRTEL":/0809|0818|0817|0908|0909|0709|0819|0919|0719|0817|0718|0918/.test(t)&&(n="9MOBILE");const r=de.network;let s;if(s=n===r?(0,P.jsx)(R.A,{icon:"icon-park:success",sx:{width:20,height:20,color:"success.main"}}):(0,P.jsx)(R.A,{icon:"akar-icons:circle-alert",sx:{width:20,height:20,color:"error.main"}}),"Unable to identify network !"!==n){const e=null===O||void 0===O?void 0:O.find(e=>e.network===n);e&&oe("network",e.network)}V((0,P.jsxs)(g.A,{variant:"subtitle2",sx:{mb:.5,mt:1},children:["Network identified: ",(0,P.jsxs)("b",{children:[n," "]})," ",s,(0,P.jsx)("br",{}),(0,P.jsxs)("i",{children:[(0,P.jsx)("b",{children:"NB:"})," Ignore if number is ported."]})]}))},error:!!le.phone,helperText:null===(n=le.phone)||void 0===n?void 0:n.message}),q,(0,P.jsx)(v.A,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:B,children:"Proceed"})]}),"VERIFY"===z&&(0,P.jsxs)(f.A,{spacing:3,children:[(0,P.jsxs)(g.A,{variant:"body2",align:"center",children:["A 6-digit OTP has been sent to ",(0,P.jsx)("b",{children:de.phone}),". Please enter it below to proceed."]}),(0,P.jsx)(j.A,{sx:{p:2,bgcolor:te?"error.lighter":"info.lighter",borderRadius:1,textAlign:"center"},children:(0,P.jsxs)(f.A,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,children:[(0,P.jsx)(R.A,{icon:te?"mdi:alert-circle":"mdi:clock-outline",width:20}),(0,P.jsx)(g.A,{variant:"subtitle2",color:te?"error.darker":"info.darker",children:te?"OTP Expired":"OTP expires in ".concat(Q,"s")})]})}),te&&(0,P.jsx)(w.A,{severity:"warning",sx:{textAlign:"center"},children:"Your OTP has expired. Please request a new one."}),(0,P.jsx)(S.o3,{name:"otp",label:"Enter 6-Digit OTP",type:"number",error:!!le.otp,helperText:null===(r=le.otp)||void 0===r?void 0:r.message,disabled:te}),(0,P.jsx)(f.A,{direction:"row",justifyContent:"flex-end",children:(0,P.jsx)(v.A,{size:"small",onClick:async()=>{_(!0);try{const e=await k.A.post("/api/autopilot/a2c/otp",{network:de.network,sender_number:de.phone,amount:100});e.data.identifier&&D(e.data.identifier),ee(60),ne(!1),p("OTP resent successfully")}catch(n){var e,t;p((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Error resending OTP",{variant:"error"})}_(!1)},loading:Y,disabled:Q>45,sx:{p:0,minWidth:"auto","&:hover":{bgcolor:"transparent",textDecoration:"underline"}},children:Q>45?"Resend in ".concat(60-Q,"s"):"Resend OTP?"})}),(0,P.jsx)(v.A,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:B,disabled:te,children:"Verify & Proceed"}),(0,P.jsx)(v.A,{fullWidth:!0,variant:"outlined",onClick:()=>{F("INIT"),ee(60),ne(!1)},children:"Change Phone Number"})]}),"CONVERT"===z&&(0,P.jsxs)(f.A,{spacing:3,children:[(0,P.jsx)(j.A,{sx:{p:2,bgcolor:"background.neutral",borderRadius:1},children:(0,P.jsxs)(f.A,{direction:"row",justifyContent:"space-between",children:[(0,P.jsx)(g.A,{variant:"subtitle2",children:"SIM Airtime Balance:"}),(0,P.jsxs)(g.A,{variant:"subtitle2",color:"primary.main",children:["\u20a6",H]})]})}),(0,P.jsx)(S.o3,{name:"amount",label:"Amount to Convert",type:"number",onChange:async e=>{const t=e.target.value;if(oe("amount",t),t>0)try{const e=await k.A.post("/api/airtimecash/discount/admin",{amount:t,network:de.network});J(e.data.amount)}catch(n){J(null)}else J(null)},error:!!le.amount,helperText:null===(o=le.amount)||void 0===o?void 0:o.message}),null!==K&&(0,P.jsx)(j.A,{sx:{p:2,bgcolor:"success.lighter",borderRadius:1},children:(0,P.jsxs)(f.A,{direction:"row",justifyContent:"space-between",children:[(0,P.jsx)(g.A,{variant:"subtitle2",color:"success.darker",children:"You will receive:"}),(0,P.jsxs)(g.A,{variant:"subtitle2",color:"success.darker",children:["\u20a6",(0,C.KZ)(K)]})]})}),(0,P.jsx)(S.o3,{name:"transferPin",label:"Share and Sell Actual PIN",type:"password",placeholder:"Telco Transfer PIN",error:!!le.transferPin,helperText:null===(i=le.transferPin)||void 0===i?void 0:i.message}),(0,P.jsx)("input",{type:"hidden",name:"type",value:"wallet"}),X&&(0,P.jsx)(S.o3,{name:"pin",label:"System Transaction Pin",type:"password",error:!!le.pin,helperText:null===(a=le.pin)||void 0===a?void 0:a.message}),(0,P.jsx)(v.A,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"success",loading:B,children:"Convert Airtime"}),(0,P.jsx)(v.A,{fullWidth:!0,variant:"outlined",onClick:()=>F("VERIFY"),children:"Back"})]}),(0,P.jsx)(y.A,{}),(0,P.jsxs)(g.A,{variant:"caption",color:"text.secondary",align:"center",sx:{display:"block",mt:2},children:["\ud83d\udca1 To change or create share and sell PIN dial ",(0,P.jsx)("b",{children:"*32#"})," via USSD on your phone"]})]})})})})})}function O(){const{themeStretch:e}=(0,o.A)();return(0,P.jsx)(i.A,{title:"Airtime 2 Cash",children:(0,P.jsxs)(r.A,{maxWidth:!e&&"lg",children:[(0,P.jsx)(a.A,{heading:"Airtime 2 Cash",links:[{name:"Dashboard",href:s.nB.root},{name:"Airtime - Cash"}]}),(0,P.jsx)(N,{})]})})}},22698(e,t,n){n.d(t,{A:()=>P});var r=n(58168),s=n(98587),o=n(65043),i=n(58387),a=n(98610),l=n(88092),d=n(34535),c=n(98206),u=n(85865),p=n(67266),h=n(66734),m=n(70579);const x=(0,h.A)((0,m.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");var v=n(72949);const g=["slots","slotProps"],A=(0,d.Ay)(v.A,{name:"MuiBreadcrumbCollapsed"})(e=>{let{theme:t}=e;return(0,r.A)({display:"flex",marginLeft:"calc(".concat(t.spacing(1)," * 0.5)"),marginRight:"calc(".concat(t.spacing(1)," * 0.5)")},"light"===t.palette.mode?{backgroundColor:t.palette.grey[100],color:t.palette.grey[700]}:{backgroundColor:t.palette.grey[700],color:t.palette.grey[100]},{borderRadius:2,"&:hover, &:focus":(0,r.A)({},"light"===t.palette.mode?{backgroundColor:t.palette.grey[200]}:{backgroundColor:t.palette.grey[600]}),"&:active":(0,r.A)({boxShadow:t.shadows[0]},"light"===t.palette.mode?{backgroundColor:(0,p.tL)(t.palette.grey[200],.12)}:{backgroundColor:(0,p.tL)(t.palette.grey[600],.12)})})}),b=(0,d.Ay)(x)({width:24,height:16});const f=function(e){const{slots:t={},slotProps:n={}}=e,o=(0,s.A)(e,g),i=e;return(0,m.jsx)("li",{children:(0,m.jsx)(A,(0,r.A)({focusRipple:!0},o,{ownerState:i,children:(0,m.jsx)(b,(0,r.A)({as:t.CollapsedIcon,ownerState:i},n.collapsedIcon))}))})};var j=n(92532),w=n(72372);function y(e){return(0,w.Ay)("MuiBreadcrumbs",e)}const k=(0,j.A)("MuiBreadcrumbs",["root","ol","li","separator"]),S=["children","className","component","slots","slotProps","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"],C=(0,d.Ay)(u.A,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(e,t)=>[{["& .".concat(k.li)]:t.li},t.root]})({}),I=(0,d.Ay)("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(e,t)=>t.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),R=(0,d.Ay)("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(e,t)=>t.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8});function T(e,t,n,r){return e.reduce((s,o,i)=>(i<e.length-1?s=s.concat(o,(0,m.jsx)(R,{"aria-hidden":!0,className:t,ownerState:r,children:n},"separator-".concat(i))):s.push(o),s),[])}const P=o.forwardRef(function(e,t){const n=(0,c.b)({props:e,name:"MuiBreadcrumbs"}),{children:d,className:u,component:p="nav",slots:h={},slotProps:x={},expandText:v="Show path",itemsAfterCollapse:g=1,itemsBeforeCollapse:A=1,maxItems:b=8,separator:j="/"}=n,w=(0,s.A)(n,S),[k,R]=o.useState(!1),P=(0,r.A)({},n,{component:p,expanded:k,expandText:v,itemsAfterCollapse:g,itemsBeforeCollapse:A,maxItems:b,separator:j}),N=(e=>{const{classes:t}=e;return(0,a.A)({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},y,t)})(P),O=(0,l.A)({elementType:h.CollapsedIcon,externalSlotProps:x.collapsedIcon,ownerState:P}),E=o.useRef(null),q=o.Children.toArray(d).filter(e=>o.isValidElement(e)).map((e,t)=>(0,m.jsx)("li",{className:N.li,children:e},"child-".concat(t)));return(0,m.jsx)(C,(0,r.A)({ref:t,component:p,color:"text.secondary",className:(0,i.A)(N.root,u),ownerState:P},w,{children:(0,m.jsx)(I,{className:N.ol,ref:E,ownerState:P,children:T(k||b&&q.length<=b?q:(e=>A+g>=e.length?e:[...e.slice(0,A),(0,m.jsx)(f,{"aria-label":v,slots:{CollapsedIcon:h.CollapsedIcon},slotProps:{collapsedIcon:O},onClick:()=>{R(!0);const e=E.current.querySelector("a[href],button,[tabindex]");e&&e.focus()}},"ellipsis"),...e.slice(e.length-g,e.length)])(q),N.separator,j,P)})}))})}}]);
//# sourceMappingURL=2475.ff50a8d0.chunk.js.map