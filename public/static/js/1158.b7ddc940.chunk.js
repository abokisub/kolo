"use strict";(self.webpackChunkabokisub_recovered=self.webpackChunkabokisub_recovered||[]).push([[1158],{50467(e,t,a){a.d(t,{A:()=>c});var r=a(80045),i=a(89379),n=a(34535),o=a(90310),s=a(70579);const l=["color","variant","children"],d=(0,n.Ay)("span")(e=>{let{theme:t,ownerState:a}=e;const r="light"===t.palette.mode,{color:n,variant:s}=a;return(0,i.A)({height:22,minWidth:22,lineHeight:0,borderRadius:8,cursor:"default",alignItems:"center",whiteSpace:"nowrap",display:"inline-flex",justifyContent:"center",padding:t.spacing(0,1),color:t.palette.grey[800],fontSize:t.typography.pxToRem(12),fontFamily:t.typography.fontFamily,backgroundColor:t.palette.grey[300],fontWeight:t.typography.fontWeightBold},"default"!==n?(0,i.A)((0,i.A)((0,i.A)({},"filled"===s&&(0,i.A)({},(e=>({color:t.palette[e].contrastText,backgroundColor:t.palette[e].main}))(n))),"outlined"===s&&(0,i.A)({},(e=>({color:t.palette[e].main,backgroundColor:"transparent",border:"1px solid ".concat(t.palette[e].main)}))(n))),"ghost"===s&&(0,i.A)({},(e=>({color:t.palette[e][r?"dark":"light"],backgroundColor:(0,o.X4)(t.palette[e].main,.16)}))(n))):(0,i.A)((0,i.A)({},"outlined"===s&&{backgroundColor:"transparent",color:t.palette.text.primary,border:"1px solid ".concat(t.palette.grey[50032])}),"ghost"===s&&{color:r?t.palette.text.secondary:t.palette.common.white,backgroundColor:t.palette.grey[50016]}))});function c(e){let{color:t="default",variant:a="ghost",children:n}=e,o=(0,r.A)(e,l);return(0,s.jsx)(d,(0,i.A)((0,i.A)({ownerState:{color:t,variant:a}},o),{},{children:n}))}},12609(e,t,a){a.r(t),a.d(t,{default:()=>F});var r=a(65043),i=a(46987),n=a(19252),o=a(12110),s=a(79650),l=a(71806),d=a(73460),c=a(28076),u=a(10039),h=a(96446),A=a(77739),g=a(17392),p=a(19090),x=a(90035),v=a(4219),m=a(35316),f=a(85865),j=a(67784),b=a(29347),y=a(78977),C=a(73023),w=a.n(C),S=a(11737),D=a(19838),k=a(50467),R=a(26776),_=a(90797),M=a(12670),T=a(24753),N=(a(73338),a(84473)),P=a(78868),W=a(70579);const I=[{id:"username",label:"User",alignRight:!1},{id:"card_id",label:"Card ID",alignRight:!1},{id:"card_pan",label:"Card PAN",alignRight:!1},{id:"card_type",label:"Type",alignRight:!1},{id:"status",label:"Status",alignRight:!1},{id:"created_at",label:"Created At",alignRight:!1},{id:"action",label:"Action",alignRight:!0}];function F(){var e;const{themeStretch:t}=(0,S.A)(),[a,C]=(0,r.useState)([]),[F,L]=(0,r.useState)(0),[U,V]=(0,r.useState)(10),[z,B]=(0,r.useState)(0),[E,K]=(0,r.useState)(!0),[O,q]=(0,r.useState)(""),[H,X]=(0,r.useState)(!1),[Q,Y]=(0,r.useState)(!1),[$,G]=(0,r.useState)(null),[J,Z]=(0,r.useState)(""),[ee,te]=(0,r.useState)(null),{enqueueSnackbar:ae}=(0,i.dh)(),re=window.localStorage.getItem("accessToken");(0,r.useEffect)(()=>{ie(F,U,O)},[F,U,O]);const ie=async(e,t,a)=>{K(!0);try{const r=await N.A.get("/api/all/virtual/cards/".concat(re,"/secure?page=").concat(e,"&rowsPerPage=").concat(t,"&search=").concat(a));"success"===r.data.status&&(C(r.data.data),B(r.data.total))}catch(r){ae("Failed to fetch cards",{variant:"error"})}finally{K(!1)}},ne=!E&&0===a.length;return(0,W.jsxs)(D.A,{title:"Management: Virtual Cards",children:[(0,W.jsxs)(n.A,{maxWidth:!t&&"lg",children:[(0,W.jsx)(T.A,{heading:"Virtual Card Management",links:[{name:"Dashboard",href:"/secure/app"},{name:"Plan",href:"/secure/plan"},{name:"Virtual Cards"}]}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)(P.Hz,{numSelected:0,filterName:O,onFilterName:e=>{q(e),L(0)},placeholder:"Search username or Card ID..."}),(0,W.jsx)(_.A,{children:(0,W.jsx)(s.A,{sx:{minWidth:800},children:(0,W.jsxs)(l.A,{children:[(0,W.jsx)(P.K2,{order:"desc",orderBy:"created_at",headLabel:I,rowCount:a.length,onRequestSort:()=>{},onSelectAllClick:()=>{}}),(0,W.jsx)(d.A,{children:a.map(e=>{const{id:t,card_id:a,card_pan:r,card_type:i,status:n,created_at:o,username:s}=e;return(0,W.jsxs)(c.A,{hover:!0,tabIndex:-1,children:[(0,W.jsx)(u.A,{align:"left",children:s}),(0,W.jsx)(u.A,{align:"left",children:a}),(0,W.jsx)(u.A,{align:"left",children:r||"N/A"}),(0,W.jsx)(u.A,{align:"left",children:(0,W.jsx)(k.A,{color:"USD"===i?"success":"info",children:i})}),(0,W.jsx)(u.A,{align:"left",children:(0,W.jsx)(k.A,{color:"active"===n?"success":"terminated"===n?"error":"warning",children:n})}),(0,W.jsx)(u.A,{align:"left",children:o}),(0,W.jsx)(u.A,{align:"right",children:(0,W.jsxs)(h.A,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[(0,W.jsx)(A.A,{title:"View Details",children:(0,W.jsx)(g.A,{color:"info",onClick:()=>(async e=>{try{const t=await N.A.get("/api/admin/card/customer/info/".concat(e,"/").concat(re,"/secure"));"success"===t.data.status&&(te(t.data.data),Y(!0))}catch(t){ae("Failed to fetch details",{variant:"error"})}})(a),children:(0,W.jsx)(R.A,{icon:"eva:eye-fill"})})}),(0,W.jsx)(A.A,{title:"Debit/Withdraw",children:(0,W.jsx)(g.A,{color:"warning",onClick:()=>(G(e),Z(""),void X(!0)),children:(0,W.jsx)(R.A,{icon:"eva:minus-circle-fill"})})}),(0,W.jsx)(A.A,{title:"Terminate",children:(0,W.jsx)(g.A,{color:"error",disabled:"terminated"===n,onClick:()=>{return e=a,void w()({title:"Terminate Card?",text:"This will block the card on Xixapay and set it to Terminated locally.",icon:"warning",buttons:!0,dangerMode:!0}).then(async t=>{if(t)try{const t=await N.A.post("/api/admin/terminate/virtual/card/".concat(re,"/secure"),{card_id:e});"success"===t.data.status&&(ae(t.data.message),ie(F,U,O))}catch(i){var a,r;ae((null===(a=i.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"Action failed",{variant:"error"})}});var e},children:(0,W.jsx)(R.A,{icon:"eva:slash-fill"})})}),(0,W.jsx)(A.A,{title:"Delete Record",children:(0,W.jsx)(g.A,{color:"secondary",disabled:"terminated"!==n,onClick:()=>{return e=a,void w()({title:"Delete Record?",text:"This will permanently remove the card record. Only terminated cards can be deleted.",icon:"warning",buttons:!0,dangerMode:!0}).then(async t=>{if(t)try{const t=await N.A.post("/api/admin/delete/virtual/card/".concat(re,"/secure"),{card_id:e});"success"===t.data.status&&(ae(t.data.message),ie(F,U,O))}catch(i){var a,r;ae((null===(a=i.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"Delete failed",{variant:"error"})}});var e},children:(0,W.jsx)(R.A,{icon:"eva:trash-2-fill"})})})]})})]},t)})}),ne&&(0,W.jsx)(d.A,{children:(0,W.jsx)(c.A,{children:(0,W.jsx)(u.A,{align:"center",colSpan:7,sx:{py:3},children:(0,W.jsx)(M.A,{searchQuery:O})})})})]})})}),(0,W.jsx)(p.A,{rowsPerPageOptions:[5,10,25],component:"div",count:z,rowsPerPage:U,page:F,onPageChange:(e,t)=>{L(t)},onRowsPerPageChange:e=>{V(parseInt(e.target.value,10)),L(0)}})]})]}),(0,W.jsxs)(x.A,{open:H,onClose:()=>X(!1),children:[(0,W.jsx)(v.A,{children:"Debit Virtual Card"}),(0,W.jsxs)(m.A,{sx:{pt:2},children:[(0,W.jsxs)(f.A,{variant:"body2",sx:{mb:2},children:["Withdraw funds from Card ",(0,W.jsx)("b",{children:null===$||void 0===$?void 0:$.card_id})," (",null===$||void 0===$?void 0:$.card_type,")."]}),(0,W.jsx)(j.A,{fullWidth:!0,label:"Amount",placeholder:"Enter amount to debit",value:J,onChange:e=>Z(e.target.value),type:"number"})]}),(0,W.jsxs)(b.A,{children:[(0,W.jsx)(y.A,{onClick:()=>X(!1),children:"Cancel"}),(0,W.jsx)(y.A,{variant:"contained",color:"warning",onClick:async()=>{if(!J||isNaN(J)||J<=0)ae("Please enter a valid amount",{variant:"warning"});else try{"success"===(await N.A.post("/api/admin/debit/virtual/card/".concat(re,"/secure"),{card_id:$.card_id,amount:J})).data.status&&(ae("Debit successful"),X(!1),ie(F,U,O))}catch(a){var e,t;ae((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Debit failed",{variant:"error"})}},children:"Debit Card"})]})]}),(0,W.jsxs)(x.A,{open:Q,onClose:()=>Y(!1),maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(v.A,{children:"Card & Customer Details"}),(0,W.jsx)(m.A,{children:ee&&(0,W.jsxs)(h.A,{sx:{mt:2},children:[(0,W.jsx)(f.A,{variant:"subtitle2",children:"User Profile"}),(0,W.jsxs)(f.A,{variant:"body2",children:["Username: ",ee.user.username]}),(0,W.jsxs)(f.A,{variant:"body2",children:["Email: ",ee.user.email]}),(0,W.jsxs)(f.A,{variant:"body2",children:["Customer ID: ",ee.user.customer_id]}),(0,W.jsx)(f.A,{variant:"subtitle2",sx:{mt:2},children:"Platform Details"}),(0,W.jsxs)(f.A,{variant:"body2",children:["Card ID: ",ee.card.card_id]}),(0,W.jsxs)(f.A,{variant:"body2",children:["Type: ",ee.card.card_type]}),(0,W.jsxs)(f.A,{variant:"body2",children:["Status: ",ee.card.status]}),(0,W.jsx)(f.A,{variant:"subtitle2",sx:{mt:2},children:"Provider Balance (Real-time)"}),(0,W.jsxs)(f.A,{variant:"h6",color:"primary",children:["USD"===ee.card.card_type?"$":"\u20a6"," ",(null===(e=ee.provider_details)||void 0===e?void 0:e.balance)||"0.00"]})]})}),(0,W.jsx)(b.A,{children:(0,W.jsx)(y.A,{onClick:()=>Y(!1),children:"Close"})})]})]})}},29347(e,t,a){a.d(t,{A:()=>x});var r=a(98587),i=a(58168),n=a(65043),o=a(58387),s=a(98610),l=a(34535),d=a(98206),c=a(92532),u=a(72372);function h(e){return(0,u.Ay)("MuiDialogActions",e)}(0,c.A)("MuiDialogActions",["root","spacing"]);var A=a(70579);const g=["className","disableSpacing"],p=(0,l.Ay)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,!a.disableSpacing&&t.spacing]}})(e=>{let{ownerState:t}=e;return(0,i.A)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})}),x=n.forwardRef(function(e,t){const a=(0,d.b)({props:e,name:"MuiDialogActions"}),{className:n,disableSpacing:l=!1}=a,c=(0,r.A)(a,g),u=(0,i.A)({},a,{disableSpacing:l}),x=(e=>{const{classes:t,disableSpacing:a}=e,r={root:["root",!a&&"spacing"]};return(0,s.A)(r,h,t)})(u);return(0,A.jsx)(p,(0,i.A)({className:(0,o.A)(x.root,n),ownerState:u,ref:t},c))})},35316(e,t,a){a.d(t,{A:()=>v});var r=a(98587),i=a(58168),n=a(65043),o=a(58387),s=a(98610),l=a(34535),d=a(98206),c=a(92532),u=a(72372);function h(e){return(0,u.Ay)("MuiDialogContent",e)}(0,c.A)("MuiDialogContent",["root","dividers"]);var A=a(87034),g=a(70579);const p=["className","dividers"],x=(0,l.Ay)("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.dividers&&t.dividers]}})(e=>{let{theme:t,ownerState:a}=e;return(0,i.A)({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},a.dividers?{padding:"16px 24px",borderTop:"1px solid ".concat((t.vars||t).palette.divider),borderBottom:"1px solid ".concat((t.vars||t).palette.divider)}:{[".".concat(A.A.root," + &")]:{paddingTop:0}})}),v=n.forwardRef(function(e,t){const a=(0,d.b)({props:e,name:"MuiDialogContent"}),{className:n,dividers:l=!1}=a,c=(0,r.A)(a,p),u=(0,i.A)({},a,{dividers:l}),A=(e=>{const{classes:t,dividers:a}=e,r={root:["root",a&&"dividers"]};return(0,s.A)(r,h,t)})(u);return(0,g.jsx)(x,(0,i.A)({className:(0,o.A)(A.root,n),ownerState:u,ref:t},c))})},4219(e,t,a){a.d(t,{A:()=>x});var r=a(58168),i=a(98587),n=a(65043),o=a(58387),s=a(98610),l=a(85865),d=a(34535),c=a(98206),u=a(87034),h=a(2563),A=a(70579);const g=["className","id"],p=(0,d.Ay)(l.A,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),x=n.forwardRef(function(e,t){const a=(0,c.b)({props:e,name:"MuiDialogTitle"}),{className:l,id:d}=a,x=(0,i.A)(a,g),v=a,m=(e=>{const{classes:t}=e;return(0,s.A)({root:["root"]},u.t,t)})(v),{titleId:f=d}=n.useContext(h.A);return(0,A.jsx)(p,(0,r.A)({component:"h2",className:(0,o.A)(m.root,l),ownerState:v,ref:t,variant:"h6",id:null!=d?d:f},x))})},87034(e,t,a){a.d(t,{A:()=>o,t:()=>n});var r=a(92532),i=a(72372);function n(e){return(0,i.Ay)("MuiDialogTitle",e)}const o=(0,r.A)("MuiDialogTitle",["root"])},3900(e,t,a){a.d(t,{A:()=>n});a(65043);var r=a(66734),i=a(70579);const n=(0,r.A)((0,i.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},51639(e,t,a){a.d(t,{A:()=>n});a(65043);var r=a(66734),i=a(70579);const n=(0,r.A)((0,i.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")}}]);
//# sourceMappingURL=1158.b7ddc940.chunk.js.map